<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Secret Santa Assignment</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 20px;
    }
    .container {
      max-width: 500px;
      margin: 0 auto;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 8px;
      background-color: #f9f9f9;
    }
    h1 {
      color: #2d87f0;
    }
    p {
      font-size: 18px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      background-color: #2d87f0;
      color: white;
      border: none;
      border-radius: 5px;
    }
    button:hover {
      background-color: #1d6ccf;
    }
  </style>
</head>
<body>

<div class="container">
  <h1>Secret Santa Assignment</h1>
  <p>Click the button below to reveal who you are buying a gift for!</p>
  <button onclick="revealSanta()">Reveal</button>
  <p id="assignedPerson"></p>
</div>

<script>
  // List of participants (update this with the names of your participants)
  const participants = [
    "Alice", "Bob", "Charlie", "David", "Eve", 
    "Frank", "Grace", "Hannah", "Ivan", "Jack"
  ];

  // Randomly shuffle the participants and assign them
  function assignSecretSanta() {
    const shuffledParticipants = [...participants];
    for (let i = shuffledParticipants.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [shuffledParticipants[i], shuffledParticipants[j]] = [shuffledParticipants[j], shuffledParticipants[i]];
    }
    
    // Ensure no one is assigned to themselves
    const assignments = {};
    for (let i = 0; i < participants.length; i++) {
      assignments[participants[i]] = shuffledParticipants[i === participants.length - 1 ? 0 : i + 1];
    }
    
    return assignments;
  }

  // Store the assignments in a variable (this will be available for the page)
  const secretSantaAssignments = assignSecretSanta();

  // Base64 encoding and decoding functions
  function encodeBase64(str) {
    return btoa(unescape(encodeURIComponent(str)));  // Encoding the name to Base64
  }

  function decodeBase64(encodedStr) {
    return decodeURIComponent(escape(atob(encodedStr)));  // Decoding Base64 to get original name
  }

  // Get the name from the URL parameters (e.g. ?name=QWxpY2U=)
  function getParticipantFromURL() {
    const urlParams = new URLSearchParams(window.location.search);
    const encodedName = urlParams.get('name');
    if (encodedName) {
      return decodeBase64(encodedName);  // Decode Base64 to get the participant name
    }
    return null;
  }

  // Function to reveal the assigned person based on URL query parameter
  function revealSanta() {
    const participant = getParticipantFromURL();

    if (participants.includes(participant)) {
      const assignedPerson = secretSantaAssignments[participant];
      document.getElementById("assignedPerson").textContent = `You are buying a gift for: ${assignedPerson}`;
    } else {
      alert("Sorry, your name is not in the list. Please check the spelling or ask the organizer.");
    }
  }

  // Automatically reveal the assignment when the page loads
  document.addEventListener('DOMContentLoaded', () => {
    const participant = getParticipantFromURL();
    if (participant) {
      revealSanta();
    }
  });

</script>

</body>
</html>
